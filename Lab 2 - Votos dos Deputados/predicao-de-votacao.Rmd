---
title: "Predição de Votação de Deputados"
author: "Hugo Gabriel"
date: "11 de dezembro de 2017"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = TRUE)

library(caret)
library(tidyverse)
```

```{r}
dados_votos <- read.csv("eleicoes2014.csv", encoding = "latin1")

dados_votos <- dados_votos %>%
  select(-c(nome, sequencial_candidato, numero_cadidato, cargo))
# setor_economico_receita, setor_economico_despesa, 
dados_votos[is.na(dados_votos)] <- 0
```

```{r}
smp_size <- floor(.7*nrow(dados_votos))
set.seed(123)
train_id <- sample(seq_len(nrow(dados_votos)), size = smp_size)

treino <- dados_votos[train_id,]
teste <- dados_votos[-train_id,]

control <- trainControl(method = "cv", number = 5)
```

### Modelo de Regressão Ridge

```{r}
lambdaGrid <- expand.grid(lambda = 10^seq(10, -2, length=100))

model.ridge <- train(votos~., 
                     data = treino,
                     method = "ridge",
                     trControl = control,
                     preProcess = c('scale', 'center', 'nzv'),
                     tuneGrid = lambdaGrid,
                     metric = "lambda")

model.ridge
```

### Modelo de Regressão Lasso

```{r}
model.lasso <- train(votos~., 
                     data = treino,
                     method = "lasso",
                     trControl = control,
                     preProcess = c('scale', 'center'))

model.lasso
```

### Modelo de Regressão KNN

```{r}
model.knn <- train(votos~., 
                     data = treino,
                     method = "knn",
                     trControl = control,
                     preProcess = c('scale', 'center'))

model.knn

plot(model.knn, xvar="lambda")
plot(model.lasso, xvar="lambda")
plot(model.ridge)
```